# Phase 1 Configuration: Local Bloch Problems at Frozen Registry
# This config controls how Phase 1 computes local band structure data

# ===== Candidate Selection =====
K_candidates: 1  # Number of top candidates from Phase 0 to process

# ===== Moiré Spatial Grid =====
phase1_Nx: 64  # Number of grid points in x direction
phase1_Ny: 64  # Number of grid points in y direction
effective_moire_scale: 10.0  # For monolayer: effective "moiré scale" as multiple of lattice constant

# ===== Twist Geometry =====
tau: [0.0, 0.0]  # Stacking gauge vector (default: no shift)
eta: auto  # Twist center gauge; use 'auto' for a/L_moire
default_theta_deg: 1.1  # Default twist applied to monolayer candidates

# ===== MPB Computation Settings =====
phase1_resolution: 32  # MPB resolution (lower for speed, typical: 16-32)
phase1_dk: 0.01  # Finite difference step in k-space (units of 2π/a)
phase1_fd_order: 4  # Finite-difference accuracy for derivatives (2 or 4)
num_bands: 8  # Number of bands to compute
quiet_mpb: true  # Suppress MPB stdout/stderr
phase1_auto_from_phase0p5: true  # Inherit resolution/Δk recommendations when Phase 0.5 exists

# ===== Parallelization =====
phase1_parallel: true  # Use MPI ranks (mpirun -n <R>) to distribute registry points
phase1_max_workers: 4  # Legacy knob for older multiprocessing path; kept for compatibility only
phase1_registry_progress_stride: 8
phase1_rank_logging: false
phase1_rank_logging_stride: 128

# ===== Reference Frequency =====
# Options: 'min', 'max', 'mean', 'median'
ref_frequency_mode: 'mean'

# ===== Output Settings =====
output_dir: "runs"
save_reference_band: false  # Whether to save 1D reference band structure
