# Photonic Bistritzer-MacDonald Model

Step-by-step construction of a **photonic continuum moiré model** in direct analogy to the Bistritzer–MacDonald electronic model.  Broken into stages, highlighted where the photonic version differs, and pointed out the key approximations (and where they may fail). 

---

## 1. Start from Maxwell’s “master equation” in 2D

In a 2D photonic crystal (in-plane periodic dielectric, TE polarization) the relevant eigenproblem is

$$
\nabla\times\Bigl[\tfrac{1}{\varepsilon(\mathbf r)}\,\nabla\times \mathbf H(\mathbf r)\Bigr]
= \frac{\omega^2}{c^2}\,\mathbf H(\mathbf r)\,,
$$

where

* $\mathbf H = H_z(\mathbf r)\,\hat{\mathbf z}$ (out-of-plane field),
* $\varepsilon(\mathbf r)$ is the periodic dielectric constant,
* $\omega$ the mode frequency.

> **Note:**  Unlike electrons, photons have no Fermi velocity or mass—$\omega(k)$ plays the role of the dispersion, and $c$ is the “speed of light” analogue of $v_F$.

---

## 2. Isolating a Dirac–like point in a single layer

1. **Design a lattice with accidental degeneracy.**  
   Choose a 2D lattice (e.g. triangular) and tune the dielectric contrast (radius of pillars or holes) so that two bands touch linearly at a corner of the Brillouin zone (the photonic “K” point).

2. **Expand near the degeneracy.**  
   Let $\mathbf k = \mathbf K + \mathbf q$ with $|\mathbf q|\ll|\mathbf K|$.  One finds

   $$
   H_\text{ph}^{(0)}(-i\nabla)
   \approx
   v_\text{ph}\,\bigl(\sigma_x\,q_x + \sigma_y\,q_y\bigr)\,,
   $$

   where $v_\text{ph}$ is the slope $\bigl|\nabla_{\!k}\,\omega\bigr|$ at the Dirac point and $\sigma_{x,y}$ act on the two nearly-degenerate Bloch modes.

> **Photon vs. Electron:**
>
> * Electron: $H_{\rm e}^{(0)} = -i\hbar v_F\,\boldsymbol\sigma\cdot\nabla$.
> * Photon: $H_{\rm ph}^{(0)} = -i\,\hbar_{\rm eff}\,v_{\rm ph}\,\boldsymbol\sigma\cdot\nabla$,  
>   where $\hbar_{\rm eff}$ is a formal Planck’s constant to keep dimensions consistent (can be set to 1 in normalized units).

---

## 3. Building two twisted layers

We now stack **two identical photonic crystals**, each supporting a Dirac point, and twist them by $\pm\theta/2$.

* **Coordinate rotation:**  for layer 1 use $\mathbf r_1 = R(+\theta/2)\,\mathbf r$; for layer 2 $\mathbf r_2 = R(-\theta/2)\,\mathbf r$.
* **Single-layer operators:**

  $$
  H_{\rm ph}^{(1)} = H_{\rm ph}^{(0)}\bigl(-i\,R(+\tfrac\theta2)\nabla\bigr),\quad
  H_{\rm ph}^{(2)} = H_{\rm ph}^{(0)}\bigl(-i\,R(-\tfrac\theta2)\nabla\bigr).
  $$

> **Key point:**  rotating the lattice simply rotates the Dirac cones in momentum space.

---

## 4. Inter-layer coupling: the photonic tunneling ansatz

Physically, light in one layer can evanescently “leak” into the other through the small gap (or via radiative coupling).  We model this by a position-dependent coupling operator $T_{\rm ph}(\mathbf r)$ that is **periodic on the moiré scale** $L_M\approx a/[2\sin(\theta/2)]$.

### Ansatz: keep only three lowest harmonics

$$
T_{\rm ph}(\mathbf r)
\;=\;
\sum_{j=1}^3
T_j^{(\rm ph)}\;\exp\bigl(-i\,\mathbf q_j\!\cdot\!\mathbf r\bigr),
$$

where

* $\mathbf q_j$ are the three moiré reciprocal vectors (magnitude $k_\theta$),
* $T_j^{(\rm ph)}$ are $2\times2$ matrices whose entries are **mode-overlap integrals**  
  $\displaystyle [T_j]_{\mu\nu}=\int\! \psi^{(1)}_\mu(\mathbf r)\,\delta\varepsilon(\mathbf r)\,\psi^{(2)}_\nu(\mathbf r)\,d^2r,$  
  with $\delta\varepsilon=\varepsilon_1(\mathbf r)-\varepsilon_2(\mathbf r)$.

> **Approximation:**  because $L_M \gg$ unit-cell, higher Fourier components are small.

---

## 5. The full photonic moiré Hamiltonian

Combine layers and coupling in a block form (in the basis $\{\psi^{(1)}_{\!A},\psi^{(1)}_{\!B},\psi^{(2)}_{\!A},\psi^{(2)}_{\!B}\}$):

$$
H_{\rm ph}(\mathbf r)
=
\begin{pmatrix}
H_{\rm ph}^{(1)} & T_{\rm ph}(\mathbf r) \\[6pt]
T_{\rm ph}^\dagger(\mathbf r) & H_{\rm ph}^{(2)}
\end{pmatrix}.
$$

The eigenvalue equation $H_{\rm ph}\,\Psi=\omega\,\Psi$ yields the **photonic band structure** $\omega(\mathbf k)$ on the super-moiré Brillouin zone.

---

## 6. Key approximations & their limits

| Approximation                     | Why it’s made                                                    | Where it breaks                                                                                                   |
| --------------------------------- | ---------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- |
| **Continuum (Dirac) limit**       | Avoids huge supercells; captures low-energy (frequency) physics. | When $\theta$ is large → moiré period comparable to lattice constant → atomic-scale details matter.               |
| **Single-mode per valley**        | Keeps a $2\times2$ block for each layer; tractable.              | If other bands lie close in frequency → multimode mixing.                                                         |
| **Smooth coupling (3 harmonics)** | Higher harmonics decay as $1/G$; usually negligible.             | Strong dielectric contrast or small twist where $\delta\varepsilon$ has sharp features.                           |
| **No polarization mixing**        | TE modes decouple from TM in ideal 2D PC slab.                   | In real 3D slabs, TE/TM mix near light-cone → need full-vector Maxwell.                                           |
| **Lossless, linear media**        | Standard PC assumption.                                          | Nonlinear effects (Kerr), material absorption, radiation loss → modify $T_j$ and add imaginary parts to $\omega$. |
| **No intervalley scattering**     | Moiré coupling only connects same-valley Dirac cones.            | If defects or disorder create large-momentum scattering.                                                          |

---

## 7. Practical steps to implement

1. **Design single-layer PC**  
   * Use MPB or COMSOL to find a Dirac point at $\mathbf K$.  
   * Extract $v_{\rm ph}=\bigl|\nabla_k\omega\bigr|$ and the modal Bloch functions $\psi_{A,B}(\mathbf r)$.

2. **Compute overlap matrices**  
   * Numerically evaluate $[T_j]_{\mu\nu}=\int\!\psi^{(1)}_\mu\,\delta\varepsilon\,\psi^{(2)}_\nu$.  
   * Keep only three principal $\mathbf q_j$.

3. **Assemble continuum Hamiltonian**  
   * Write each block $H_{\rm ph}^{(\ell)}(-i\nabla)$ in Fourier space around $\mathbf K$.  
   * Diagonalize the $4\times4$ moiré Hamiltonian on a coarse $\mathbf q$-grid of the moiré BZ.

4. **Validate & compare**  
   * Check against a reduced PWE on a commensurate supercell for a few twist angles.  
   * Identify flat bands and “magic” angles where the bandwidth nearly vanishes.

---

### Take-home message

The **photonic BM model** trades a massive PWE supercell for a small, continuum $4\times4$ eigenproblem—enabling to scan twist angles, coupling strengths, and nonlinearities far more cheaply.  
But caution: whenever the moiré period shrinks, other bands crowd in, or material losses/polarization play a role, the approximations here will need refinement (e.g. adding more Fourier harmonics, more bands, or moving back to a full-wave solver).
